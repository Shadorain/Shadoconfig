#!/bin/bash
export DISPLAY=:0
xhost +

DIRECTORY=/home/shadow/Pictures/Backgrounds/.rot/*
RECOVER=/home/shadow/Pictures/Backgrounds/.rot/.store
file=""

rand () {
    set -- $DIRECTORY
    rnd="$RANDOM$RANDOM$RANDOM"
    file="$(eval 'echo "${'$((1 + $rnd % $#))'}"')"
    check
}

check () {
    # Display BG + Check #
    if [[ -f $RECOVER ]]
    then
        if [[ $(<$RECOVER) == $file ]]
        then
            rand
        elif [[ $file == "" ]]
        then
            rand
        else
            /usr/bin/feh --bg-scale --no-fehbg $file
            # Save for later #
            echo $file > $RECOVER
        fi
    else
        /usr/bin/feh --bg-scale --no-fehbg $file $file $file
        # Save for later #
        echo $file > $RECOVER
    fi
}
check
